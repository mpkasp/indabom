{% load materializecss %}
{% load static %}

<a class="waves-effect waves-light btn btn-primary modal-trigger modal-{{ name }}"
   href="#modal-{{ name }}">{{ modal_title }}</a>

<div id="modal-{{ name }}" class="modal left-align">
    <form name="seller" action="{{ action }}" method="post" class="col s12" enctype="multipart/form-data">
        <div class="modal-content">
            <div class="row">
                <div class="col s12">
                    {% if modal_title %}<h4 class="light">{{ modal_title }}</h4>{% endif %}
                    <div class="divider"></div>
                </div>
                <div class="col s12">
                {% if is_pro and user_can_manage_members %}
                    {% csrf_token %}
                    <p class="flow-text-small grey-text text-darken-2">To add a user, ensure they have already created an IndaBOM account and are not currently part of another organization.
                        Then, enter their <b>username</b> (not email) and select their role below.</p>
                    {{ form|materializecss:'m6 s12' }}
                {% elif is_pro and not user_can_manage_members %}
                    <p class="flow-text-small red-text text-darken-1">
                        **Access Restricted:** Please contact an organization administrator to add new members to your team.
                    </p>
                {% else %}
                    <div class="col s12" style="padding: 15px; background-color: #e0f2f1; border-left: 5px solid #009688;">
                        <div style="display:flex; align-items:center; margin-bottom: 10px;">
                            <i class="material-icons left teal-text text-darken-1" style="margin-right: 8px;">workspace_premium</i>
                            <strong class="teal-text text-darken-2">Upgrade to IndaBOM Pro</strong>
                        </div>

                        <p class="grey-text text-darken-3" style="margin-top: 0;">
                            Unlock collaboration features by inviting additional users to your organization. Pro includes:
                        </p>
                        <ul class="browser-default" style="margin-top: 8px; margin-left: 20px;">
                            <li>Multiple users per organization</li>
                            <li>Role-based access (Admin/Viewer)</li>
                            <li>Priority support</li>
                        </ul>
                    </div>
                {% endif %}
                </div>
            </div>
        </div>
<div class="modal-footer">
            <a href="#!" class="modal-close waves-effect waves-light btn-flat grey-text text-darken-2">Cancel</a>
            {% if is_pro and user_can_manage_members %}
                <button class="waves-effect waves-light btn teal darken-1" type="submit" name="submit_{{ name }}">
                    Add Member
                </button>
            {% elif is_pro and not user_can_manage_members %}
                <a href="#!" class="modal-close waves-effect waves-light btn-flat teal-text text-darken-1">Ok</a>
                {% else %}
                <a href="{% url 'pricing' %}" class="btn-flat grey-text text-darken-1">View Pricing</a>
                            <a href="{% url 'checkout' %}" class="btn waves-effect waves-light teal darken-1">
                                Go Pro
                            </a>
            {% endif %}
        </div>
    </form>
</div>

{% block script %}
    <script>
        $(document).ready(function () {
            $('.modal').modal();
        });
    </script>
{% endblock %}